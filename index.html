<!DOCTYPE html>
<html>

<head>
    <title>RTI_UniGraz</title>

	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta charset="UTF-8" />

	<!-- bootstrap -->
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>

	<!-- openlime style -->
	<link rel="icon" type="image/png" href="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+CjxzdmcKICAgeG1sbnM6ZGM9Imh0dHA6Ly9wdXJsLm9yZy9kYy9lbGVtZW50cy8xLjEvIgogICB4bWxuczpzdmc9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogICB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciCiAgIHdpZHRoPSI2MnB4IgogICBoZWlnaHQ9IjYycHgiCiAgIHZpZXdCb3g9IjAgMCA2MiA2MiIKICAgdmVyc2lvbj0iMS4xIj4KICA8Y2lyY2xlCiAgICAgdHJhbnNmb3JtPSJyb3RhdGUoNDUpIgogICAgIHN0eWxlPSJvcGFjaXR5OjE7ZmlsbDojZmFjZDVhO2ZpbGwtb3BhY2l0eToxIgogICAgIGN4PSI0My44NDA2MjIiCiAgICAgY3k9IjAiCiAgICAgcj0iMjguODgxNjk3IiAvPgogIDxwYXRoCiAgICAgZD0ibSAzOC4zOTk2OTUsMjcuMDUxODA5IC03LjkzNjQzNiwtNC42MTIwMjIgLTEuMjY1OTc2LC0xLjI2NTk3NiAtOC4wOTgzOTUsLTguMDk4Mzk1IC0yLjk1NzIzNCwtMi45NTcyMzQgYyAtMC43MDEzNTEsLTAuNzAxMzUwNSAtMS44MzA1OTcsLTAuNzAxMzU0IC0yLjUzMTk0OCwtMmUtNiBsIC01LjA1MzM4Niw1LjA1MzM4NiBjIC0wLjcwMTM1MjYsMC43MDEzNTIgLTAuNzAxMzQ5LDEuODMwNTk4IDNlLTYsMi41MzE5NDggbCAyLjk1NzIzMywyLjk1NzIzNSA4LjA5ODM5NSw4LjA5ODM5NSAxLjI2NTk3NSwxLjI2NTk3NSA0LjYxMjAyMiw3LjkzNjQzNyA1LjY3NDYzLDUuNjc0NjMxIDEwLjkwOTc0OCwtMTAuOTA5NzQ3IHoiCiAgICAgc3R5bGU9ImZpbGw6IzVmODJjMzsiLz4KICA8cGF0aCBkPSJtIDM4LjM5OTY5MiwyNy4wNTE4MTIgMi4yODEwNjksMi4yODEwNyAtMTAuOTA5NzQ0LDEwLjkwOTc0NCAtMi4yODEwNjksLTIuMjgxMDcgeiIKICAgICBzdHlsZT0iZmlsbDojNDE1YTg3OyIvPgogIDxjaXJjbGUKICAgICB0cmFuc2Zvcm09InJvdGF0ZSg0NSkiCiAgICAgcj0iMS43MTg0MjI4IgogICAgIGN5PSItMC4zMDk4MDYyOSIKICAgICBjeD0iMzYuOTc3MjI2IgogICAgIHN0eWxlPSJmaWxsOiMwMDAwMDA7ZmlsbC1vcGFjaXR5OjAuMjQ3NDc0NzYiLz4KICA8cGF0aAogICAgIGQ9Ik0gNTkuMDUzMDkyLDM3LjIwOTcgNDMuMTc3MjMsMzMuNjIzMjI1IDMzLjkwODMwMSw0Mi44OTIxNTMgYyAwLDAgMS45ODAxNjIsOS4yMjExNiAzLjQ0NjE1OSwxNi4xMDA5NTIgQSAyOC44ODE2OTcsMjguODgxNjk3IDAgMCAwIDUxLjMwNDI1OSw1MS4zMDQxOTkgMjguODgxNjk3LDI4Ljg4MTY5NyAwIDAgMCA1OS4wNTMwOTIsMzcuMjA5NyBaIgogICAgIHN0eWxlPSJmaWxsOiNmY2UwOTQ7Ii8+CiAgPHBhdGgKICAgICBkPSJtIDU2Ljc4NTczOCw0My41NzQwMDMgLTE0Ljk1OTA1NCwtOC42MDAyMzIgLTYuNDE0NzMsNi40MTQ3MyA4LjczMzI0MSwxNS4xMzczNzMgYSAyOC44ODE2OTcsMjguODgxNjk3IDAgMCAwIDcuMTU5MDY0LC01LjIyMTY3NSAyOC44ODE2OTcsMjguODgxNjk3IDAgMCAwIDUuNDgxNDc5LC03LjczMDE5NiB6IgogICAgIHN0eWxlPSJmaWxsOiNmZWY5ZDQ7Ii8+Cjwvc3ZnPgo=">
	<link rel="stylesheet" href="skin.css"/>

	<style>
html, body {
	margin: 0px;
	padding: 0px;
	height: 100%;
}

#openlime {
	position:relative;
	height: 100%
}

#openlime>canvas {
	width: 100%;
	height: 100%;
	/* this is important, it would cause firefox flickering! */
	overflow: hidden;
}

	</style>
</head>

<body>

	<header>
		<div class="container">
			<div class="row flex">
				<div class="col-10">
					<h1>Seals collection</h1>
					<h2>RTI viewer</h2>
				</div>
				<div class="col-2">
					<div>
						<a href="http://www.uni-graz.at" class="unilogo" target="_blank">
							<img src="https://static.uni-graz.at/fileadmin/grafik/logos/Logo_Uni-Graz_4c.jpg" alt="University of Graz Logo" style="max-height: 100px;">
						</a>
					</div>
				</div>
			</div>
		</div>
	</header>

	<!-- to add navbar and other pages eventually -->
<div class="container">
<p>	Presenting the results of RTI with the seals collection of the Department of History, University of Graz.
</p>
</div>

<div class="container">
	<div class="row">
		<!-- choose seal -->
		<div class="col-md-2">
			<p>Click on an object number to see it.</p>
			<ul id="seals">
			    <li id="062">062</li>
    			<li id="070">070</li>
				<li id="071">071</li>
				<li id="085">085</li>
			</ul>
		</div>	
		<!-- viewer -->
		<div class="col-md-10" id="openlime">
		</div>
</div>

	<footer class="footer" style="padding-top: 25px;">
		<div class="container">
			<div class="row">
				<div class="col-md-6">
					<h6>Weitere Informationen</h6>
					<p>
						<a href="...">Link</a>
						<br/>
					</p>
					<p>
						<a href="...">Impressum</a>
						<br/>
					</p>
					<div>
						Add licenses
					</div>
				</div>
				<div class="col-md-6">
					<h6>Contact</h6>
					<p>
						Tanja<br/>
						Department of History
							<br/>University of Graz
					</p>
					<p>
						Chiara Zuanni<br/>
						Department of Digital Humanities
							<br/>University of Graz
					</p>
					<p>
						<a href="mailto:chiara.zuanni@uni-graz.at">chiara.zuanni@uni-graz.at</a>
					</p>
				</div>
			</div>
		</div>
	</footer>

</body>

<script src="openlime.min.js"></script>
<script>
//variables for seal selection
var seal;
var current;
var repo;

var plane0tzi;
var plane0dzi;
var planes;
var plane0jpg; 
var normalstzi; 
var normalsdzi;
var normalsjpg;
var infojson;

document.getElementById("seals").addEventListener("click",function(e) {
        if(e.target && e.target.nodeName == "LI") {
        // console.log(e.target.id);
        current = e.target.id;
		var repo = "https://github.com/kia-z/RTI-website-seals/tree/objects";
		var seal = `${repo}/rti_${current}`;
		// console.log(seal) 

		// variables needed for each object in viewer
 		plane0tzi = `/${seal}/plane_0.tzi`
 		plane0dzi = `/${seal}/plane_0.dzi`
 		planes = `/${seal}/planes.tzi`
 		plane0jpg = `/${seal}/plane_0.jpg`
 		normalstzi = `/${seal}/normals.tzi`
 		normalsdzi = `/${seal}/normals.dzi`
 		normalsjpg = `/${seal}/normals.jpg`
 		infojson = `/${seal}/info.json`

//autodetect type:
async function autodetect() {
	let response = await fetch(plane0tzi);
	if(response.status == 200)
		return "tarzoom";

	response = await fetch(plane0dzi);
	if(response.status == 200)
		return "deepzoom";

        response = await fetch(planes);
        if(response.status == 200)
                return "itarzoom";

	response = await fetch(plane0jpg);
	if(response.status == 200)
                return "image";

	alert("Could not detect an RTI here");
	return "";
}

async function autodetectNormals(layout) {
	if(layout == 'tarzoom') {
		let response = await fetch(normalstzi);
		if(response.status == 200)
			return true;
	}
	if(layout == 'deepzoom') {
		let response = await fetch(normalsdzi);
		if(response.status == 200)
			return true;
	}
	if(layout == 'image') {
		let response = await fetch(normalsjpg);
		if(response.status == 200)
			return true;
	}

	return false;
}

async function init() {
	let layout = await autodetect();
	let normals = await autodetectNormals(layout);
	var lime = new OpenLIME.Viewer('#openlime', { background:'black' });

	let layer = new OpenLIME.Layer({ 
		layout: layout, 
		type:'rti',
		url: infojson,
		normals: normals
	});

	lime.canvas.addLayer('RTI', layer); 
	OpenLIME.Skin.setUrl('skin.svg');
	let ui = new OpenLIME.UIBasic(lime, { skin: 'skin.svg', showLightDirections: true });
	ui.actions.light.active = true;
	ui.actions.layers.display = true;
	lime.camera.maxFixedZoom = 1;
	window.lime = lime;
}

init();

}	
});

</script>

</html>
